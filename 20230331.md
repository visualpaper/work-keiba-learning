20230325_binary_model_wide

5000000 train

```
try:
    model = keras.models.load_model('./../model/binary_model_wide')
except:
    print("create")
    # Kerasを使ってモデルを作成します。
    model = keras.models.Sequential([
        keras.layers.Flatten(input_shape=(1,) + env.observation_space.shape),
        keras.layers.Dense(128, activation="elu"),
        keras.layers.Dense(128, activation='elu'),
        keras.layers.BatchNormalization(),
        keras.layers.Dense(128, activation='elu'),
        keras.layers.Dense(128, activation='elu'),
        keras.layers.Dropout(0.3),
        keras.layers.Dense(nb_actions, activation="linear"),
    ])

model.summary()
    
# 経験値を蓄積するためのメモリです。学習を安定させるために使用します。
memory = SequentialMemory(limit=50000, window_length=1)

# 行動ポリシーはBoltzmannQPolicyを使用しています。
# EpsGreedyQPolicyと比較して、こちらの方が収束が早かったので採用しています。
policy = EpsGreedyQPolicy()

# DQNAgentを作成します。
dqn = DQNAgent(
    model=model,
    nb_actions=nb_actions,
    memory=memory,
    target_model_update=1e-2,
    policy=policy)

# DQNAgentのコンパイル。最適化はAdam,評価関数はMAEを使用します。
dqn.compile(Adam(learning_rate=1e-4), metrics=[
    keras.losses.BinaryCrossentropy(from_logits=True, name='binary_crossentropy'), 'accuracy'
])

# 学習開始
history = dqn.fit(env, nb_steps=10000000, visualize=False, log_interval=34462, verbose=1)


Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten (Flatten)           (None, 10)                0         
                                                                 
 dense (Dense)               (None, 128)               1408      
                                                                 
 dense_1 (Dense)             (None, 128)               16512     
                                                                 
 batch_normalization (BatchN  (None, 128)              512       
 ormalization)                                                   
                                                                 
 dense_2 (Dense)             (None, 128)               16512     
                                                                 
 dense_3 (Dense)             (None, 128)               16512     
                                                                 
 dropout (Dropout)           (None, 128)               0         
                                                                 
 dense_4 (Dense)             (None, 11)                1419      
                                                                 
=================================================================
Total params: 52,875
Trainable params: 52,619
Non-trainable params: 256

[-3864.0, -1748.0, -1534.0, -1212.0, -1168.0, -926.0, -894.0, -622.0, -682.0, -622.0, -496.0, -584.0, -348.0, -542.0, -526.0, -100.0, -236.0, -272.0, -380.0, -360.0, -172.0, -206.0, 10.0, -200.0, 154.0, -36.0, 134.0, 132.0, 312.0, 374.0, 118.0, 382.0, 246.0, 364.0, 498.0, 332.0, 444.0, 400.0, 576.0, 536.0, 690.0, 638.0, 634.0, 680.0, 552.0, 776.0, 608.0, 676.0, 678.0, 826.0, 852.0, 852.0, 866.0, 1172.0, 782.0, 1036.0, 828.0, 1060.0, 976.0, 944.0, 1056.0, 624.0, 1028.0, 1086.0, 1342.0, 1210.0, 1040.0, 1292.0, 1390.0, 1134.0, 1270.0, 1082.0, 986.0, 924.0, 762.0, 550.0, 322.0, 490.0, 42.0, 212.0, -188.0, -478.0, -2272.0, -3544.0, -2236.0, -1866.0, -1654.0, -926.0, -526.0, -368.0, -464.0, -354.0, -518.0, -246.0, -396.0, 184.0, 364.0, -142.0, 410.0, 662.0, 912.0, 848.0, 1058.0, 1024.0, 1184.0, 1214.0, 1434.0, 1438.0, 1528.0, 1542.0, 1836.0, 1588.0, 1820.0, 1750.0, 1894.0, 2076.0, 2102.0, 2078.0, 2234.0, 2072.0, 2236.0, 2296.0, 1984.0, 2364.0, 2106.0, 2202.0, 2036.0, 2254.0, 2306.0, 2172.0, 2214.0, 2302.0, 2274.0, 2210.0, 2546.0, 2506.0, 2334.0, 2334.0, 2394.0, 2392.0, 2480.0, 2556.0, 2286.0, 1718.0, 2046.0, 2058.0, 2004.0, 1062.0, 146.0, -114.0, 74.0, 196.0, 612.0, 662.0, 168.0, 6.0, -642.0, -586.0, -828.0, -306.0, 306.0, 558.0, 708.0, 588.0, 1048.0, 1208.0, 1440.0, 1484.0, 1646.0, 1912.0, 1686.0, 1776.0, 1790.0, 1946.0, 1854.0, 2044.0, 2030.0, 2164.0, 2336.0, 2368.0, 2192.0, 2170.0, 2326.0, 1802.0, 1220.0, 1478.0, 794.0, 784.0, 1580.0, 1682.0, 1820.0, 748.0, 1160.0, 1816.0, 1334.0, -150.0, 1132.0, -1524.0, -1964.0, -1896.0, -2018.0, -1716.0, -1912.0, -1992.0, -1568.0, -1650.0, -1632.0, -1492.0, -1556.0, -1530.0, -1824.0, -1866.0, -1658.0, -1348.0, -1056.0, -970.0, -392.0, -182.0, 156.0, 692.0, 738.0, 838.0, 1330.0, 1224.0, 1622.0, 1726.0, 1830.0, 1790.0, 2048.0, 2244.0, 2412.0, 2270.0, 2160.0, 2386.0, 2262.0, 2400.0, 2618.0, 2696.0, 2872.0, 2780.0, 2674.0, 2812.0, 2942.0, 2948.0, 2838.0, 2706.0, 2518.0, 2320.0, 1990.0, 2334.0, 1248.0, 1858.0, 1676.0, 1078.0, 2338.0, 2212.0, 1966.0, 2440.0, 2692.0, 2158.0, 2596.0, 2656.0, 2542.0, 2528.0, 2208.0, 2598.0, 2518.0, 2468.0, 2232.0, 2552.0, 2528.0, 2528.0, 1936.0, 1634.0, 2270.0, 2026.0, 2010.0, 1306.0, 1780.0, 1580.0, 1552.0, 1692.0, 1496.0, 2242.0, 2164.0, 2334.0, 1984.0, 2296.0, 2310.0, 1792.0]
```

<br><br>

* 2013 予想

```
RANK_ONE_TWO_HORSE 回数: 168
RANK_ONE_THREE_HORSE 回数: 60
RANK_ONE_FOUR_HORSE 回数: 83
RANK_ONE_FIVE_HORSE 回数: 104
RANK_TWO_THREE_HORSE 回数: 145
RANK_TWO_FOUR_HORSE 回数: 135
RANK_TWO_FIVE_HORSE 回数: 10
RANK_THREE_FOUR_HORSE 回数: 24
RANK_THREE_FIVE_HORSE 回数: 47
RANK_FOUR_FIVE_HORSE 回数: 1
未購入回数: 2677

当たり馬券: 182
はずれ馬券: 595
的中率: 0.23423423423423423

当たり金額: 594200
購入金額: 777000
儲け: -182800
回収率: 0.7647361647361647
```

<br>

* 2014 年予想

```
RANK_ONE_TWO_HORSE 回数: 141
RANK_ONE_THREE_HORSE 回数: 51
RANK_ONE_FOUR_HORSE 回数: 78
RANK_ONE_FIVE_HORSE 回数: 76
RANK_TWO_THREE_HORSE 回数: 118
RANK_TWO_FOUR_HORSE 回数: 120
RANK_TWO_FIVE_HORSE 回数: 6
RANK_THREE_FOUR_HORSE 回数: 13
RANK_THREE_FIVE_HORSE 回数: 58
RANK_FOUR_FIVE_HORSE 回数: 1
未購入回数: 2789

当たり馬券: 157
はずれ馬券: 505
的中率: 0.23716012084592145

当たり金額: 492600
購入金額: 662000
儲け: -169400
回収率: 0.7441087613293051
```

<br>

* 2015 年予想

```
RANK_ONE_TWO_HORSE 回数: 153
RANK_ONE_THREE_HORSE 回数: 57
RANK_ONE_FOUR_HORSE 回数: 69
RANK_ONE_FIVE_HORSE 回数: 95
RANK_TWO_THREE_HORSE 回数: 116
RANK_TWO_FOUR_HORSE 回数: 117
RANK_TWO_FIVE_HORSE 回数: 12
RANK_THREE_FOUR_HORSE 回数: 20
RANK_THREE_FIVE_HORSE 回数: 49
RANK_FOUR_FIVE_HORSE 回数: 2
未購入回数: 2764

当たり馬券: 162
はずれ馬券: 528
的中率: 0.23478260869565218

当たり金額: 601900
購入金額: 690000
儲け: -88100
回収率: 0.8723188405797101
```
